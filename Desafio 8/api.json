[{"id":"95d514a7.ccdd68","type":"function","z":"6579cf65.074ad","name":"Final editting - payload and deletion","func":"\nfor (var i =0; i< msg.req.query.entities.length; i++) {\n    delete msg.req.query.entities[i].entityo;\n    delete msg.req.query.entities[i].sentimento;\n    delete msg.req.query.entities[i].mentiono;\n}\n\nfor (var i=0; i<msg.req.query.entities.length; i++) {\n    if (msg.req.query.entities[i] == null) {\n        var indexof = msg.req.query.entities.indexOf(i);\n        msg.req.query.entities.splice(indexof, 1);\n    }\n}\n\nmsg.payload = \n{\n  \"recommendation\": `${msg.req.query.recommendation.toString()}`,\n  \"entities\": msg.req.query.entities\n}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":880,"y":1040,"wires":[["472b31b3.0967"]]}]